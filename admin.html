<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard - Lecture Requests</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      /* Custom CSS for things we can't do with Tailwind */
      .smooth-transition {
        transition: all 0.3s ease-in-out;
      }

      .modal-backdrop {
        background-color: rgba(0, 0, 0, 0.5);
      }

      .status-new {
        background-color: #e3f2fd;
        color: #1976d2;
      }

      .status-creating {
        background-color: #fff8e1;
        color: #ffa000;
      }

      .status-created {
        background-color: #e8f5e9;
        color: #388e3c;
      }

      @media (max-width: 768px) {
        .responsive-table-row {
          flex-direction: column;
          gap: 0.5rem;
          padding: 1rem;
        }

        .responsive-table-cell {
          border-bottom: 1px solid #e2e8f0;
          padding: 0.5rem 0;
        }

        .responsive-table-cell:last-child {
          border-bottom: none;
        }

        .responsive-table-header {
          display: none;
        }
      }
    </style>
  </head>
  <body class="bg-gray-100 font-sans">
    <div class="min-h-screen flex flex-col">
      <!-- Header -->
      <header class="bg-white shadow-md py-4 px-6">
        <div class="flex justify-between items-center">
          <h1 class="text-2xl font-bold text-indigo-700">Admin Dashboard</h1>
          <div class="flex items-center space-x-4">
            <button
              class="p-2 rounded-full bg-gray-100 hover:bg-gray-200 smooth-transition"
            >
              <i class="fas fa-bell text-gray-600"></i>
            </button>
            <div
              class="w-10 h-10 rounded-full bg-indigo-500 flex items-center justify-center text-white font-semibold"
            >
              AD
            </div>
          </div>
        </div>
      </header>

      <!-- Main Content -->
      <div class="flex flex-1">
        <!-- Sidebar -->
        <aside class="w-64 bg-white shadow-md hidden md:block">
          <nav class="p-4">
            <ul class="space-y-2">
              <li>
                <a
                  href="#"
                  class="flex items-center p-2 rounded-lg bg-indigo-100 text-indigo-700"
                >
                  <i class="fas fa-chalkboard-teacher mr-3"></i>
                  <span>Lecture Requests</span>
                </a>
              </li>
              <li>
                <a
                  href="#"
                  class="flex items-center p-2 rounded-lg hover:bg-gray-100 smooth-transition"
                >
                  <i class="fas fa-book mr-3"></i>
                  <span>Lessons</span>
                </a>
              </li>
              <li>
                <a
                  href="#"
                  class="flex items-center p-2 rounded-lg hover:bg-gray-100 smooth-transition"
                >
                  <i class="fas fa-users mr-3"></i>
                  <span>Users</span>
                </a>
              </li>
              <li>
                <a
                  href="#"
                  class="flex items-center p-2 rounded-lg hover:bg-gray-100 smooth-transition"
                >
                  <i class="fas fa-cog mr-3"></i>
                  <span>Settings</span>
                </a>
              </li>
            </ul>
          </nav>
        </aside>

        <!-- Main Content Area -->
        <main class="flex-1 p-3 overflow-x-auto">
          <div class="bg-white rounded-lg shadow-md p-6">
            <!-- Page Header -->
            <div
              class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4"
            >
              <h2 class="text-xl font-bold text-gray-800 mb-4 md:mb-0">
                Lecture Requests Management
              </h2>
              <button
                id="createRequestBtn"
                class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg flex items-center smooth-transition"
              >
                <i class="fas fa-plus mr-2"></i>
                Create Request
              </button>
            </div>

            <!-- Search and Filters -->
            <div class="mb-6">
              <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                <div class="md:col-span-2">
                  <input
                    type="text"
                    id="searchInput"
                    placeholder="Search by lecture name..."
                    class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                  />
                </div>
                <div>
                  <select
                    id="classFilter"
                    class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                  >
                    <option value="">All Classes</option>
                    <option value="Class 1">Class 1</option>
                    <option value="Class 2">Class 2</option>
                    <option value="Class 3">Class 3</option>
                    <option value="Class 4">Class 4</option>
                  </select>
                </div>
                <div>
                  <select
                    id="subjectFilter"
                    class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                  >
                    <option value="">All Subjects</option>
                    <option value="Math">Math</option>
                    <option value="Science">Science</option>
                    <option value="English">English</option>
                    <option value="History">History</option>
                  </select>
                </div>
                <div>
                  <select
                    id="chapterFilter"
                    class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                  >
                    <option value="">All Chapters</option>
                    <option value="Chapter 1">Chapter 1</option>
                    <option value="Chapter 2">Chapter 2</option>
                    <option value="Chapter 3">Chapter 3</option>
                  </select>
                </div>
              </div>
            </div>

            <!-- Requests Table -->
            <div class="overflow-x-auto">
              <table class="min-w-full bg-white">
                <thead class="responsive-table-header">
                  <tr
                    class="bg-gray-50 text-left text-gray-700 uppercase text-sm"
                  >
                    <th class="py-3 px-4">Request ID</th>
                    <th class="py-3 px-4">Created At</th>
                    <th class="py-3 px-4">Requester</th>
                    <th class="py-3 px-4">Lecture Name</th>
                    <th class="py-3 px-4">Class</th>
                    <th class="py-3 px-4">Subject</th>
                    <th class="py-3 px-4">Lecture Link</th>
                    <th class="py-3 px-4">Status</th>
                    <th class="py-3 px-4">Actions</th>
                  </tr>
                </thead>
                <tbody id="requestsTableBody" class="divide-y divide-gray-200">
                  <!-- Data will be populated here -->
                </tbody>
              </table>
            </div>

            <!-- Empty State -->
            <div id="emptyState" class="text-center py-10 hidden">
              <i class="fas fa-inbox text-4xl text-gray-300 mb-3"></i>
              <h3 class="text-lg font-medium text-gray-500">
                No lecture requests found
              </h3>
              <p class="text-gray-400 mt-1">
                Create your first lecture request to get started
              </p>
            </div>

            <!-- Pagination -->
            <div class="flex justify-between items-center mt-6">
              <div class="text-sm text-gray-500">
                Showing <span id="startItem">1</span> to
                <span id="endItem">5</span> of
                <span id="totalItems">12</span> entries
              </div>
              <div class="flex space-x-1">
                <button
                  class="px-3 py-1 rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 smooth-transition"
                >
                  <
                </button>
                <button
                  class="px-3 py-1 rounded-lg border border-gray-300 bg-indigo-600 text-white smooth-transition"
                >
                  1
                </button>
                <button
                  class="px-3 py-1 rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 smooth-transition"
                >
                  2
                </button>
                <button
                  class="px-3 py-1 rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 smooth-transition"
                >
                  >
                </button>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <!-- Create Request Modal -->
    <div
      id="createRequestModal"
      class="fixed inset-0 z-50 flex items-center justify-center hidden"
    >
      <div class="modal-backdrop absolute inset-0"></div>
      <div
        class="bg-white rounded-lg shadow-xl z-10 w-full max-w-md mx-4 smooth-transition"
      >
        <div class="p-6">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-xl font-semibold text-gray-800">
              Create New Lecture Request
            </h3>
            <button
              id="closeCreateModal"
              class="text-gray-400 hover:text-gray-500"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
          <form id="requestForm" class="space-y-4">
            <div>
              <label
                for="lectureName"
                class="block text-sm font-medium text-gray-700 mb-1"
                >Lecture Name</label
              >
              <input
                type="text"
                id="lectureName"
                required
                class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
              />
            </div>
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label
                  for="class"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Class</label
                >
                <select
                  id="class"
                  required
                  class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                >
                  <option value="">Select Class</option>
                  <option value="1">Class 1</option>
                  <option value="2">Class 2</option>
                  <option value="3">Class 3</option>
                  <option value="4">Class 4</option>
                  <option value="5">Class 5</option>
                  <option value="">Class 6</option>
                  <option value="7">Class 7</option>
                  <option value="8">Class 8</option>
                  <option value="9">Class 9</option>
                  <option value="10">Class 10</option>
                  <option value="11">Class 11</option>
                  <option value="12">Class 12</option>
                </select>
              </div>
              <div>
                <label
                  for="subject"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Subject</label
                >
                <select
                  id="subject"
                  required
                  class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                >
                  <option value="">Select Subject</option>
                  <option value="Math">Math</option>
                  <option value="Science">Science</option>
                  <option value="English">English</option>
                  <option value="History">History</option>
                </select>
              </div>
            </div>
            <div>
              <label
                for="chapter"
                class="block text-sm font-medium text-gray-700 mb-1"
                >Chapter</label
              >
              <select
                id="chapter"
                required
                class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
              >
                <option value="">Select Chapter</option>
                <option value="Chapter 1">Chapter 1</option>
                <option value="Chapter 2">Chapter 2</option>
                <option value="Chapter 3">Chapter 3</option>
              </select>
            </div>
            <div>
              <label
                for="description"
                class="block text-sm font-medium text-gray-700 mb-1"
                >Description (Optional)</label
              >
              <textarea
                id="description"
                rows="3"
                class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
              ></textarea>
            </div>
            <div class="flex justify-end space-x-3 pt-4">
              <button
                type="button"
                id="cancelRequest"
                class="px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 smooth-transition"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="px-4 py-2 bg-indigo-600 rounded-lg text-white hover:bg-indigo-700 smooth-transition"
              >
                Create Request
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div
      id="deleteConfirmModal"
      class="fixed inset-0 z-50 flex items-center justify-center hidden"
    >
      <div class="modal-backdrop absolute inset-0"></div>
      <div
        class="bg-white rounded-lg shadow-xl z-10 w-full max-w-md mx-4 smooth-transition"
      >
        <div class="p-6">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-xl font-semibold text-gray-800">
              Confirm Deletion
            </h3>
            <button
              id="closeDeleteModal"
              class="text-gray-400 hover:text-gray-500"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
          <p class="text-gray-600 mb-6">
            Are you sure you want to delete this lecture request? This action
            cannot be undone.
          </p>
          <div class="flex justify-end space-x-3">
            <button
              id="cancelDelete"
              class="px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 smooth-transition"
            >
              Cancel
            </button>
            <button
              id="confirmDelete"
              class="px-4 py-2 bg-red-600 rounded-lg text-white hover:bg-red-700 smooth-transition"
            >
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Sample data for the lecture requests
      const lectureRequests = [
        {
          id: "REQ-2023-001",
          createdAt: "2023-05-15 14:30",
          requester: "John Smith",
          lectureName: "Introduction to Algebra",
          class: "Class 1",
          subject: "Math",
          lectureLink: "",
          status: "New",
        },
        {
          id: "REQ-2023-002",
          createdAt: "2023-05-14 09:15",
          requester: "Emily Johnson",
          lectureName: "Photosynthesis Process",
          class: "Class 2",
          subject: "Science",
          lectureLink: "https://example.com/lecture/2",
          status: "Created",
        },
        {
          id: "REQ-2023-003",
          createdAt: "2023-05-13 16:45",
          requester: "Michael Brown",
          lectureName: "World War II Timeline",
          class: "Class 3",
          subject: "History",
          lectureLink: "",
          status: "Creating",
        },
        {
          id: "REQ-2023-004",
          createdAt: "2023-05-12 11:20",
          requester: "Sarah Davis",
          lectureName: "English Grammar Basics",
          class: "Class 1",
          subject: "English",
          lectureLink: "https://example.com/lecture/4",
          status: "Created",
        },
        {
          id: "REQ-2023-005",
          createdAt: "2023-05-11 13:10",
          requester: "Robert Wilson",
          lectureName: "Quadratic Equations",
          class: "Class 2",
          subject: "Math",
          lectureLink: "",
          status: "New",
        },
      ];

      // DOM Elements
      const requestsTableBody = document.getElementById("requestsTableBody");
      const emptyState = document.getElementById("emptyState");
      const createRequestBtn = document.getElementById("createRequestBtn");
      const createRequestModal = document.getElementById("createRequestModal");
      const closeCreateModal = document.getElementById("closeCreateModal");
      const cancelRequest = document.getElementById("cancelRequest");
      const requestForm = document.getElementById("requestForm");
      const deleteConfirmModal = document.getElementById("deleteConfirmModal");
      const closeDeleteModal = document.getElementById("closeDeleteModal");
      const cancelDelete = document.getElementById("cancelDelete");
      const confirmDelete = document.getElementById("confirmDelete");
      const searchInput = document.getElementById("searchInput");
      const classFilter = document.getElementById("classFilter");
      const subjectFilter = document.getElementById("subjectFilter");
      const chapterFilter = document.getElementById("chapterFilter");

      // Variables for deletion
      let requestToDelete = null;

      // Initialize the page
      document.addEventListener("DOMContentLoaded", function () {
        renderRequests(lectureRequests);

        // Modal toggle events
        createRequestBtn.addEventListener("click", () => {
          createRequestModal.classList.remove("hidden");
          console.log();
        });

        closeCreateModal.addEventListener("click", () => {
          createRequestModal.classList.add("hidden");
        });

        cancelRequest.addEventListener("click", () => {
          createRequestModal.classList.add("hidden");
        });

        closeDeleteModal.addEventListener("click", () => {
          deleteConfirmModal.classList.add("hidden");
        });

        cancelDelete.addEventListener("click", () => {
          deleteConfirmModal.classList.add("hidden");
        });

        // Form submission
        requestForm.addEventListener("submit", function (e) {
          e.preventDefault();

          // Create new request
          const newRequest = {
            id: `REQ-2023-${Math.floor(Math.random() * 900 + 100)}`,
            createdAt: new Date()
              .toISOString()
              .replace("T", " ")
              .substring(0, 16),
            requester: "mee",
            lectureName: document.getElementById("lectureName").value,
            class: document.getElementById("class").value,
            subject: document.getElementById("subject").value,
            chapter: document.getElementById("chapter").value,
            lectureLink: "",
            status: "New",
          };
          console.log(newRequest);

          lectureRequests.unshift(newRequest);
          renderRequests(lectureRequests);
          requestForm.reset();
          createRequestModal.classList.add("hidden");
        });

        // Filter events
        searchInput.addEventListener("input", filterRequests);
        classFilter.addEventListener("change", filterRequests);
        subjectFilter.addEventListener("change", filterRequests);
        chapterFilter.addEventListener("change", filterRequests);
      });

      // Render requests table
      function renderRequests(requests) {
        requestsTableBody.innerHTML = "";

        if (requests.length === 0) {
          emptyState.classList.remove("hidden");
          requestsTableBody.classList.add("hidden");
          return;
        }

        emptyState.classList.add("hidden");
        requestsTableBody.classList.remove("hidden");

        requests.forEach((request) => {
          const row = document.createElement("tr");
          row.className =
            "responsive-table-row hover:bg-gray-50 smooth-transition";

          // Status class mapping
          let statusClass = "";
          if (request.status === "New") statusClass = "status-new";
          else if (request.status === "Creating")
            statusClass = "status-creating";
          else if (request.status === "Created") statusClass = "status-created";

          const createBtnDisabled =
            request.status === "Creating" || request.status === "Created";

          row.innerHTML = `
                    <td class="responsive-table-cell py-2 px-2 font-medium text-gray-700">${
                      request.id
                    }</td>
                    <td class="responsive-table-cell py-2 px-2">${
                      request.createdAt
                    }</td>
                    <td class="responsive-table-cell py-2 px-2">${
                      request.requester
                    }</td>
                    <td class="responsive-table-cell py-2 px-2">${
                      request.lectureName
                    }</td>
                    <td class="responsive-table-cell py-2 px-2">${
                      request.class
                    }</td>
                    <td class="responsive-table-cell py-2 px-2">${
                      request.subject
                    }</td>
                    <td class="responsive-table-cell py-2 px-2">
                        ${
                          request.lectureLink
                            ? `<a href="index.html" target="_blank" class="text-indigo-600 hover:underline">View</a>`
                            : '<span class="text-gray-400">N/A</span>'
                        }
                    </td>
                    <td class="responsive-table-cell py-4 px-4">
                        <span class="px-2 py-1 rounded-full text-xs font-semibold ${statusClass}">${
            request.status
          }</span>
                    </td>
                    <td class="responsive-table-cell py-4 px-4">
                        <div class="flex space-x-2">
                            <button class="create-lecture-btn p-2 rounded-lg ${
                              createBtnDisabled
                                ? "bg-gray-200 text-gray-500 cursor-not-allowed"
                                : "bg-indigo-100 text-indigo-700 hover:bg-indigo-200 smooth-transition"
                            }" 
                                    data-id="${request.id}" ${
            createBtnDisabled ? "disabled" : ""
          }>
                                <i class="fas fa-plus"></i> Create
                            </button>
                            <button class="delete-request-btn p-2 rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200 smooth-transition" data-id="${
                              request.id
                            }">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;

          requestsTableBody.appendChild(row);
        });

        // Add event listeners to newly created buttons
        document.querySelectorAll(".create-lecture-btn").forEach((btn) => {
          btn.addEventListener("click", function () {
            const requestId = this.getAttribute("data-id");
            createLecture(requestId);
          });
        });

        document.querySelectorAll(".delete-request-btn").forEach((btn) => {
          btn.addEventListener("click", function () {
            requestToDelete = this.getAttribute("data-id");
            deleteConfirmModal.classList.remove("hidden");
          });
        });
      }

      // Create lecture function
      function createLecture(requestId) {
        const request = lectureRequests.find((req) => req.id === requestId);
        if (request) {
          request.status = "Creating";
          renderRequests(lectureRequests);

          // Simulate creation process
          setTimeout(() => {
            request.status = "Created";
            request.lectureLink = `https://example.com/lecture/${Math.floor(
              Math.random() * 1000
            )}`;
            renderRequests(lectureRequests);
          }, 3000);
        }
      }

      // Confirm delete
      confirmDelete.addEventListener("click", function () {
        if (requestToDelete) {
          const index = lectureRequests.findIndex(
            (req) => req.id === requestToDelete
          );
          if (index !== -1) {
            lectureRequests.splice(index, 1);
            renderRequests(lectureRequests);
          }
          deleteConfirmModal.classList.add("hidden");
          requestToDelete = null;
        }
      });

      // Filter requests based on search and filters
      function filterRequests() {
        const searchTerm = searchInput.value.toLowerCase();
        const selectedClass = classFilter.value;
        const selectedSubject = subjectFilter.value;
        const selectedChapter = chapterFilter.value;

        const filteredRequests = lectureRequests.filter((request) => {
          const matchesSearch = request.lectureName
            .toLowerCase()
            .includes(searchTerm);
          const matchesClass =
            selectedClass === "" || request.class === selectedClass;
          const matchesSubject =
            selectedSubject === "" || request.subject === selectedSubject;
          // Note: Since chapter data isn't in our sample data, we're not filtering by it

          return matchesSearch && matchesClass && matchesSubject;
        });

        renderRequests(filteredRequests);
      }
    </script>
  </body>
</html>
